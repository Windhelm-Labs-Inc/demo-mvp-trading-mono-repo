# Market Maker Worker Service - Environment Variables
# Copy this file to .env and fill in your actual values
# NEVER commit .env to git - add .env to .gitignore

# Hedera Account Configuration
HEDERA_ACCOUNT_ID=0.0.6978377
HEDERA_PRIVATE_KEY_DER_HEX=302e020100300506032b657004220420YOUR_PRIVATE_KEY_HERE
HEDERA_LEDGER_ID=testnet

# Authentication Configuration
# Token refresh interval in seconds (default: 800 seconds = ~13.3 minutes)
# Tokens expire after 15 minutes, so we refresh proactively before expiry
TOKEN_REFRESH_INTERVAL_SECONDS=800

# Order Update Behavior Configuration
# 1 = Atomic replacement (submit new orders first, maintains continuous liquidity)
# 0 = Sequential replacement (cancel old orders first, creates temporary liquidity gaps)
# Default: 1 (sequential/traditional behavior)
UPDATE_BEHAVIOR_FLAG=1

# Atomic Replacement Delay
# Delay in milliseconds between submitting new orders and canceling old ones (atomic mode only)
# Gives the orderbook time to process new orders before canceling old ones
# Recommended: 100-500ms, set to 0 to disable delay
# Default: 110
ATOMIC_REPLACEMENT_DELAY_MS=110

# Self-Trade Prevention
# Enable self-trade prevention in atomic mode
# When enabled, detects if new orders would cross existing orders and prevents self-trading
# 1 = Enabled (recommended for production)
# 0 = Disabled
# Default: 1
ENABLE_SELF_TRADE_PREVENTION=1

# Sequential Peel Delay
# Delay in milliseconds between levels during sequential peeling
# Used when self-trade prevention triggers side-aware sequential processing
# Recommended: 5-20ms
# Default: 5
SEQUENTIAL_PEEL_DELAY_MS=5

# Continuous Settlement Configuration
# Enable automatic position settlement
# Settlement runs at: Service startup, after token refresh, and at service shutdown
# Settlement frequency is controlled by TOKEN_REFRESH_INTERVAL_SECONDS (default: ~13 minutes)
# 1 = Enabled, 0 = Disabled
# Default: 0
CONTINUOUS_SETTLEMENT=0

# ═══════════════════════════════════════════════════════════
# Metrics Configuration (Azure Application Insights)
# ═══════════════════════════════════════════════════════════
# Enable OpenTelemetry metrics export
# When enabled, exports order placement, cancellation, STP, and index update metrics
# to Azure Application Insights
# 1 = Enabled, 0 = Disabled
# Default: 0
ENABLE_METRICS=0

# Metrics export interval in milliseconds
# Controls how often metrics are collected and sent to Application Insights
# Lower values = more frequent updates but higher overhead
# Higher values = less frequent updates but more efficient
# Recommended: 30000-120000ms (30s-2min)
# Default: 60000 (60 seconds)
METRICS_EXPORT_INTERVAL_MS=60000

# Azure Application Insights Connection String
# Get this from Azure Portal > Application Insights > Overview > Connection String
# Format: InstrumentationKey=xxx;IngestionEndpoint=https://...;LiveEndpoint=https://...;ApplicationId=xxx
# Default: Pre-configured for your Azure Application Insights instance
APPLICATIONINSIGHTS_CONNECTION_STRING=InstrumentationKey=01402b01-5969-41ad-91cc-b51cf86ba96e;IngestionEndpoint=https://eastus-8.in.applicationinsights.azure.com/;LiveEndpoint=https://eastus.livediagnostics.monitor.azure.com/;ApplicationId=2a91edf1-7d8a-462b-b346-5cb0fb6af5ad

# ═══════════════════════════════════════════════════════════
# Liquidity Ladder Configuration
# ═══════════════════════════════════════════════════════════
# These settings control the shape and size of your order book liquidity

# Number of Levels (per side)
# How many price levels to place on each side (bids and asks)
# More levels = deeper liquidity but requires more margin
# Example: 4 levels = 4 bids + 4 asks = 8 total orders at any time
# Default: 4
NUMBER_OF_LEVELS=4

# Level 0 Quantity (BTC contracts)
# Quantity for the level closest to the spread (most competitive price)
# This is in BTC contract units (e.g., 0.00001 BTC at 8 decimals = 1000 base units)
# Default: 0.00001 (1000 base units)
LEVEL_0_QUANTITY=0.00001

# Levels 1-2 Quantity (BTC contracts)
# Quantity for the second and third levels from the spread
# Typically smaller than level 0 to reduce exposure
# Default: 0.000005 (500 base units)
LEVELS_1_TO_2_QUANTITY=0.000005

# Levels 3-9 Quantity (BTC contracts)
# Quantity for levels 3 through 9 (if you have that many levels)
# Typically the smallest quantity, furthest from spread
# Default: 0.000001 (100 base units)
LEVELS_3_TO_9_QUANTITY=0.000001

# Base Spread (USD)
# The dollar spread between your best bid and best ask
# Example: 100.00 means if mid-price is $85,000, bid at $84,950, ask at $85,050
# Larger spread = lower risk but less competitive
# Default: 100.00
BASE_SPREAD_USD=100.00

# Level Spacing (USD)
# Dollar distance between each level in the ladder
# Example: 1.00 means each level is $1 apart
# Tighter spacing = more competitive pricing but orders may fill faster
# Default: 1.00
LEVEL_SPACING_USD=1.00

# Initial Margin Factor
# Fraction of position value required as margin (0.2 = 20% = 5x leverage)
# Lower = more leverage (higher risk), Higher = less leverage (lower risk)
# Range: 0.0 to 1.0 (0% to 100%)
# Default: 0.2 (20% margin = 5x leverage)
INITIAL_MARGIN_FACTOR=0.2

# Redis Configuration
# Azure Redis Cache connection string with password
# Format: host:port,ssl=True,abortConnect=False,password=YOUR_REDIS_KEY
# Get your Redis key from Azure Portal > Redis Cache > Access keys
REDIS_CONNECTION_STRING=spot-index-cache.redis.cache.windows.net:6380,ssl=True,abortConnect=False,password=YOUR_REDIS_KEY_HERE

# Logging Configuration (Optional - defaults from appsettings.json if not set)
# Valid levels: Verbose, Debug, Information, Warning, Error, Fatal
# Default: Information (filters out DEBUG logs for production)
# 
# To enable DEBUG logs for local development, uncomment these:
# Serilog__MinimumLevel__Override__MarketMakerWorkerService=Debug
# Serilog__WriteTo__0__Args__restrictedToMinimumLevel=Debug

